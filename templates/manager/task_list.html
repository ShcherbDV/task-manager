{% extends "layouts/base.html" %}
{% load crispy_forms_tags %}

{% block content %}
  <h1>
    Tasks
    <a href="{% url 'manager:task-create' %}" class="btn btn-primary link-to-page">
      Create new task
    </a>
  </h1>
    <form action="" method="get" class="form-check-inline">
      {{ search_form|crispy }}
      <input type="submit" value="Search" class="btn btn-secondary">
    </form>
  {% if task_list %}
        <div class="card border-0 shadow mb-4">
        <div class="card-body">
          <div class="table-responsive">
              <table class="table table-centered table-nowrap mb-0 rounded">
                  <thead class="thead-light">
                      <tr>
                          <th class="border-0 rounded-start">#</th>
                          <th class="border-0">Task Name</th>
                          <th class="border-0">Task Type</th>
                          <th class="border-0">Deadline</th>
                          <th class="border-0">Priority</th>
                          <th class="border-0">Completed</th>
                          <th class="border-0 rounded-end">Workers</th>
                      </tr>
                  </thead>
                  <tbody>
                      <!-- Item -->
                      {% for task in task_list %}
                      <tr>
                          <td><a href="{% url "manager:task-detail" pk=task.id %}" class="text-primary fw-bold">{{ task.id }}</a> </td>
                          <td class="fw-bold d-flex align-items-center"> <svg class="icon icon-xxs text-gray-500 me-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM4.332 8.027a6.012 6.012 0 011.912-2.706C6.512 5.73 6.974 6 7.5 6A1.5 1.5 0 019 7.5V8a2 2 0 004 0 2 2 0 011.523-1.943A5.977 5.977 0 0116 10c0 .34-.028.675-.083 1H15a2 2 0 00-2 2v2.197A5.973 5.973 0 0110 16v-2a2 2 0 00-2-2 2 2 0 01-2-2 2 2 0 00-1.668-1.973z" clip-rule="evenodd"></path></svg>
                              {{ task.name }}
                          </td>
                          <td>
                              {{ task.task_type }}
                          </td>
                          <td>
                              {{ task.deadline }}
                          </td>
                          <td>
                              {{ task.priority }}
                          </td>
                          <td>
                              <div class="row d-flex align-items-center">
                                      <div class="small fw-bold">{% if task.is_completed == True %}Yes{% else %}No{% endif %}</div>
                              </div>
                          </td>
                          <td>
                              <div class="d-flex align-items-center">
                                  <svg class="icon icon-xs me-1" viewBox="0 0 20 20"></svg>
                                  <span class="fw-bold">{{ task.assignees.count }}</span>
                              </div>
                          </td>
                      </tr>
                      {% endfor %}
                      <!-- End of Item -->
                  </tbody>
              </table>
          </div>
      </div>
  </div>

  {% else %}
    <p>There are no tasks yet...</p>
  {% endif %}
{% endblock %}
